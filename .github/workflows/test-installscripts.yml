name: windows-arch-validation
on:
  workflow_dispatch:

jobs:
  setup-dotnet:
    runs-on: windows-latest

    steps:
      - name: Download dotnet-install script
        run: |
          curl -sSL https://dot.net/v1/dotnet-install.ps1 -o dotnet-install.ps1

      # Install .NET 6 x64
      - name: Install .NET 6 x64
        run: |
          powershell -ExecutionPolicy Bypass -File dotnet-install.ps1 `
            -Runtime dotnet `
            -Version 6.0.0 `
            -Architecture x64 `
            -InstallDir $env:USERPROFILE\.dotnet-x64

      - name: Verify x64 installation
        run: |
          & "$env:USERPROFILE\.dotnet-x64\dotnet" --info

      # Install .NET 6 arm64
      - name: Install .NET 6 arm64
        run: |
          powershell -ExecutionPolicy Bypass -File dotnet-install.ps1 `
            -Runtime dotnet `
            -Version 6.0.0 `
            -Architecture arm64 `
            -InstallDir $env:USERPROFILE\.dotnet-arm64

      - name: Verify arm64 installation
        run: |
          & "$env:USERPROFILE\.dotnet-arm64\dotnet" --info
