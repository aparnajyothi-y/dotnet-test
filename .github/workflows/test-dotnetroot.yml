name: Test .NET Multiple Architectures on Windows

on:
workflow_dispatch:

jobs:
install-dotnet:
runs-on: windows-latest

steps:
  - name: Checkout repository
    uses: actions/checkout@v3

  - name: Set up PowerShell for script execution
    run: |
      Set-ExecutionPolicy Bypass -Scope Process -Force

  - name: Install .NET SDK x64
    run: |
      $dotnetVersion = "8.0.416"
      $arch = "x64"
      Invoke-WebRequest https://dot.net/v1/dotnet-install.ps1 -OutFile dotnet-install.ps1
      ./dotnet-install.ps1 -Version $dotnetVersion -Architecture $arch -InstallDir "$env:USERPROFILE\.dotnet\x64"

  - name: Verify .NET SDK x64
    run: |
      $env:PATH="$env:USERPROFILE\.dotnet\x64;$env:PATH"
      dotnet --list-sdks

  - name: Install .NET SDK x86
    run: |
      $dotnetVersion = "8.0.416"
      $arch = "x86"
      Invoke-WebRequest https://dot.net/v1/dotnet-install.ps1 -OutFile dotnet-install.ps1
      ./dotnet-install.ps1 -Version $dotnetVersion -Architecture $arch -InstallDir "$env:USERPROFILE\.dotnet\x86"

  - name: Verify .NET SDK x86
    run: |
      $env:PATH="$env:USERPROFILE\.dotnet\x86;$env:PATH"
      dotnet --list-sdks
